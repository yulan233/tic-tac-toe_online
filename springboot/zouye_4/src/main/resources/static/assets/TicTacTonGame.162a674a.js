import{a as k}from"./index.7f6f19a2.js";import{_ as y,u as b,f as M,r as m,g as x,o as p,c as h,a as n,b as C,i as c,t as l,F as I,m as R,l as J}from"./index.1f288341.js";const O={class:"game_body"},T={class:"jie_shao"},z={class:"game_user card-header"},F={class:"item text"},B={class:"item text"},G={class:"item text"},V={class:"game_opponent card-header"},E={class:"item text"},L={class:"item text"},U={class:"item text"},$={class:"gameLayout"},j=["id","onClick","src"],A={id:"huihe_message"},D=J("testFasong"),W={name:"TicTacTonGame",setup(q){let v=b();const d=M();let u=d.WebSocket,f=d.roomMessage.data.roomId,_=!0;const s=m({username:"",id:"",token:"",winRate:"",frist:!0,isCan:!0}),t=m({username:"",id:"",winRate:"",frist:!0,isCan:!0});u.onmessage=function(a){const e=JSON.parse(a.data);if(console.log(e),console.log(111),e.code=="first"&&(s.value.frist=!0,s.value.isCan=!0,t.value.frist=!1,t.value.isCan=!1),e.code=="second"&&(s.value.frist=!1,s.value.isCan=!1,t.value.frist=!0,t.value.isCan=!0),e.code=="stop"&&(_=!1,alert(e.msg),v.push("/usershow")),e.code=="continue"){const o=parseInt(e.data.x)*3+parseInt(e.data.y);t.value.frist?i.value[o].status=1:i.value[o].status=2,s.value.isCan=!0,t.value.isCan=!1}if(e.code=="stop1"&&(_=!1,alert(e.msg),v.push("/usershow")),e.code=="stop2"){_=!1;const o=parseInt(e.data.x)*3+parseInt(e.data.y);t.value.frist?i.value[o].status=1:i.value[o].status=2,alert(e.msg),v.push("/usershow")}e.code=="test"&&alert(e.msg)};const w=()=>{let a=JSON.parse(sessionStorage.getItem("user"));s.value.token=JSON.parse(sessionStorage.getItem("token")),s.value.winRate=a.winRate,s.value.username=a.username,s.value.id=a.id;const e=d.roomMessage.data.sid;k.post("http://49.232.153.11:6655/api/user/getUserMessage",{id:e}).then(o=>{if(o.data.code==200){if(console.log(o.data),t.value.username=o.data.data.username,t.value.id=o.data.data.id,t.value.winRate=o.data.data.winRate,Number(s.value.id)<Number(t.value.id)){const g={code:"start",data:{roomId:f}};console.log(g),u.send(JSON.stringify(g))}}else o.data.code=="tokenError"?(alert(o.data.res),v.push("/")):alert(o.data.res)})},i=m([{value:0,status:0},{value:1,status:0},{value:2,status:0},{value:3,status:0},{value:4,status:0},{value:5,status:0},{value:6,status:0},{value:7,status:0},{value:8,status:0}]),N=a=>{if(i.value[a].status==0&&s.value.frist&&s.value.isCan){i.value[a].status=1,s.value.isCan=!1,t.value.isCan=!0;const e={code:"lozi",data:{x:parseInt(a/3),y:a%3,roomId:f}};u.send(JSON.stringify(e))}if(i.value[a].status==0&&!s.value.frist&&s.value.isCan){i.value[a].status=2,s.value.isCan=!1,t.value.isCan=!0;const e={code:"lozi",data:{x:parseInt(a/3),y:a%3,roomId:f}};u.send(JSON.stringify(e))}},S=()=>{const a=d.roomMessage.data.sid,e={code:"test",data:{id:a}};u.send(JSON.stringify(e))};return w(),setInterval(()=>{const a=d.roomMessage.data.sid,e={code:"testClose",data:{id:a,roomId:f}};_&&u.send(JSON.stringify(e))},3e3),(a,e)=>{const o=x("el-card"),g=x("el-button");return p(),h(I,null,[n("div",O,[n("div",T,[C(o,{class:"box-card"},{header:c(()=>[n("div",z,[n("span",null,"\u540D\u5B57\uFF1A"+l(s.value.username),1)])]),default:c(()=>[n("div",F,"\u80DC\u7387\uFF1A"+l(s.value.winRate),1),n("div",B,"\u5148\u624B\uFF1A"+l(s.value.frist),1),n("div",G,"\u4F60\u7684\u56DE\u5408\uFF1A"+l(s.value.isCan),1)]),_:1}),C(o,{class:"box-card"},{header:c(()=>[n("div",V,[n("span",null,"\u540D\u5B57\uFF1A"+l(t.value.username),1)])]),default:c(()=>[n("div",E,"\u80DC\u7387\uFF1A"+l(t.value.winRate),1),n("div",L,"\u5148\u624B\uFF1A"+l(t.value.frist),1),n("div",U,"\u4F60\u7684\u56DE\u5408\uFF1A"+l(t.value.isCan),1)]),_:1})]),n("div",$,[(p(!0),h(I,null,R(i.value,(r,H)=>(p(),h("img",{id:r.value,class:"grid",onClick:K=>N(r.value),src:r.status==0?"../src/assets/gridz-export.png":r.status==1?"../src/assets/grid.png":"../src/assets/gridz.png"},null,8,j))),256))])]),n("div",A,[C(g,{onClick:e[0]||(e[0]=r=>S())},{default:c(()=>[D]),_:1})])],64)}}};var X=y(W,[["__scopeId","data-v-418e2c5b"]]);export{X as default};
